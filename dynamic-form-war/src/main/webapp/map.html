<!DOCTYPE html>
<html lang="en">
<head>
<meta charset=utf-8>
<meta name="viewport" content="width=620">
<title>HTML5 Demo: geolocation</title>
<script src="./js/h5utils.js"></script>
</head>
<body>


	<header>
		<h1>Geolocalização</h1>
	</header>


	<script type="text/javascript"
		src="http://maps.google.com/maps/api/js?sensor=false"></script>
	<article>
		<p>
			Sua localização <span id="status">verificando...</span>
		</p>
	</article>
	<script>
			function success(position) {
				var s = document.querySelector('#status');

				if (s.className == 'success') {
					// not sure why we're hitting this twice in FF, I think it's to do with a cached result coming back    
					return;
				}

				s.innerHTML = "você foi encontrado!";
				s.className = 'sucesso';

				var mapcanvas = document.createElement('div');
				mapcanvas.id = 'mapcanvas';
				mapcanvas.style.height = '400px';
				mapcanvas.style.width = '560px';

				document.querySelector('article').appendChild(mapcanvas);

				var latlng = new google.maps.LatLng(position.coords.latitude,
						position.coords.longitude);
				var myOptions = {
					zoom : 15,
					center : latlng,
					mapTypeControl : false,
					navigationControlOptions : {
						style : google.maps.NavigationControlStyle.SMALL
					},
					mapTypeId : google.maps.MapTypeId.ROADMAP
				};
				var map = new google.maps.Map(document
						.getElementById("mapcanvas"), myOptions);

				var marker = new google.maps.Marker({
					position : latlng,
					map : map,
					title : "You are here! (at least within a "
							+ position.coords.accuracy + " meter radius)"
				});
			}

			function error(msg) {
				var s = document.querySelector('#status');
				s.innerHTML = typeof msg == 'string' ? msg : "failed";
				s.className = 'fail';

				// console.log(arguments);
			}

			if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(success, error);
			} else {
				error('not supported');
			}
		</script>

	<script src="./js/prettify.packed.js"></script>
	<script>
			var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl."
					: "http://www.");
			document
					.write(unescape("%3Cscript src='"
							+ gaJsHost
							+ "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		</script>
	<script>
			try {
				var pageTracker = _gat._getTracker("UA-1656750-18");
				pageTracker._trackPageview();
			} catch (err) {
			}
		</script>


	<p>Click the button to get your coordinates.</p>

	<button onclick="getLocation()">Try It</button>

	<p id="demo"></p>

	<script>
var x = document.getElementById("demo");

function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
    } else { 
        x.innerHTML = "Geolocation is not supported by this browser.";
    }
}

function showPosition(position) {
    document.form.latitude.value = position.coords.latitude;
    document.form.longitude.value = position.coords.longitude;
}
</script>

	<form id="form" name="form" action="rs/v1/geolocations" method="post">


		
		<input type="hidden" name="idusuario" id="idusuario" value='1'>
		
		
		<label for="address">Ip</label>
		<p>
			<input type="text" name="address" id="address">
		</p>
		
		<label for="msg">Mensagem</label>
		<p>
			<input type="text" name="msg" id="msg">
		</p>
		
		<label for="latitude">Latitude</label>
		<p>
			<input type="text" name="latitude" id="latitude">
		</p>
		
		<label for="longitude">Longitude</label>
		<p>
			<input type="text" name="longitude" id="longitude">
		</p>
		
		<input type="submit" class="btn btn-small btn-primary" value='Enviar Dados'>

	</form>


</body>
</html>